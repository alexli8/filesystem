(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{397:function(t,_,v){"use strict";v.r(_);var r=v(46),d=Object(r.a)({},(function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"perf命令"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#perf命令"}},[t._v("#")]),t._v(" perf命令")]),t._v(" "),v("h3",{attrs:{id:"_1-介绍"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-介绍"}},[t._v("#")]),t._v(" 1.介绍")]),t._v(" "),v("p",[t._v("perf是Linux下的一款性能分析工具，能够进行函数级与指令级的热点查找。")]),t._v(" "),v("p",[t._v("perf的原理是这样的：每隔一个固定的时间，就在CPU上（每个核上都有）产生一个中断，在中断上看看，当前是哪个pid，哪个函数，然后给对应的pid和函数加一个统计值，这样，我们就知道CPU有百分几的时间在某个pid，或者某个函数上了。")]),t._v(" "),v("h3",{attrs:{id:"_2-命令参数"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-命令参数"}},[t._v("#")]),t._v(" 2.命令参数")]),t._v(" "),v("h4",{attrs:{id:"_1-perf-top"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-perf-top"}},[t._v("#")]),t._v(" (1)perf top")]),t._v(" "),v("p",[t._v("实时显示系统/进程的性能统计信息")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("信息")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("-e")]),t._v(" "),v("td",[t._v("指定性能事件")])]),t._v(" "),v("tr",[v("td",[t._v("-a")]),t._v(" "),v("td",[t._v("显示在所有CPU上的性能统计信息")])]),t._v(" "),v("tr",[v("td",[t._v("-C")]),t._v(" "),v("td",[t._v("显示在指定CPU上的性能统计信息")])]),t._v(" "),v("tr",[v("td",[t._v("-p")]),t._v(" "),v("td",[t._v("指定进程PID")])]),t._v(" "),v("tr",[v("td",[t._v("-t")]),t._v(" "),v("td",[t._v("指定线程TID")])]),t._v(" "),v("tr",[v("td",[t._v("-K")]),t._v(" "),v("td",[t._v("隐藏内核统计信息")])]),t._v(" "),v("tr",[v("td",[t._v("-U")]),t._v(" "),v("td",[t._v("隐藏用户空间的统计信息")])]),t._v(" "),v("tr",[v("td",[t._v("-s")]),t._v(" "),v("td",[t._v("指定待解析的符号信息")])]),t._v(" "),v("tr",[v("td",[t._v("‘‐G’ or‘‐‐call‐graph’")]),t._v(" "),v("td")])])]),t._v(" "),v("ul",[v("li",[t._v("graph: 使用调用树，将每条调用路径进一步折叠。这种显示方式更加直观。\n每条调用路径的采样率为绝对值。也就是该条路径占整个采样域的比率。")]),t._v(" "),v("li",[t._v("fractal: 默认选项。类似与 graph，但是每条路径前的采样率为相对值。")]),t._v(" "),v("li",[t._v("flat: 不折叠各条调用")]),t._v(" "),v("li",[t._v("选项 call_order 用以设定调用图谱的显示顺序，该选项有 2个取值，分别是callee 与caller。将该选项设为callee 时，perf按照被调用的顺序显示调用图谱，上层函数被下层函数所调用。该选项被设为caller 时，按照调用顺序显示调用图谱，即上层函数调用了下层函数路径，也不显示每条调用路径的采样率")])]),t._v(" "),v("p",[t._v("注： Perf top需要root权限")]),t._v(" "),v("h4",{attrs:{id:"_2-perf-stat"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-perf-stat"}},[t._v("#")]),t._v(" (2)Perf stat")]),t._v(" "),v("p",[t._v("分析系统/进程的整体性能概况")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("参数")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("-e")]),t._v(" "),v("td",[t._v("选择性能事件")])]),t._v(" "),v("tr",[v("td",[t._v("-i")]),t._v(" "),v("td",[t._v("禁止子任务继承父任务的性能计数器。")])]),t._v(" "),v("tr",[v("td",[t._v("-r")]),t._v(" "),v("td",[t._v("重复执行 n 次目标程序，并给出性能指标在n 次执行中的变化范围。")])]),t._v(" "),v("tr",[v("td",[t._v("-n")]),t._v(" "),v("td",[t._v("仅输出目标程序的执行时间，而不开启任何性能计数器。")])]),t._v(" "),v("tr",[v("td",[t._v("-a")]),t._v(" "),v("td",[t._v("指定全部cpu")])]),t._v(" "),v("tr",[v("td",[t._v("-C")]),t._v(" "),v("td",[t._v("指定某个cpu")])]),t._v(" "),v("tr",[v("td",[t._v("-A")]),t._v(" "),v("td",[t._v("将给出每个处理器上相应的信息。")])]),t._v(" "),v("tr",[v("td",[t._v("-p")]),t._v(" "),v("td",[t._v("指定待分析的进程id")])]),t._v(" "),v("tr",[v("td",[t._v("-t")]),t._v(" "),v("td",[t._v("指定待分析的线程id")])])])]),t._v(" "),v("h4",{attrs:{id:"输出含义"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#输出含义"}},[t._v("#")]),t._v(" 输出含义")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("参数")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("task‐clock")]),t._v(" "),v("td",[t._v("事件表示目标任务真正占用处理器的时间，单位是毫秒。也称任务执行时间")])]),t._v(" "),v("tr",[v("td",[t._v("context-switches")]),t._v(" "),v("td",[t._v("系统发生上下文切换的次数")])]),t._v(" "),v("tr",[v("td",[t._v("CPU-migrations")]),t._v(" "),v("td",[t._v("任务从一个处理器迁往另外一个处理器的次数")])]),t._v(" "),v("tr",[v("td",[t._v("page-faults")]),t._v(" "),v("td",[t._v("内核发生缺页的次数")])]),t._v(" "),v("tr",[v("td",[t._v("cycles")]),t._v(" "),v("td",[t._v("程序消耗的处理器周期数")])]),t._v(" "),v("tr",[v("td",[t._v("instructions")]),t._v(" "),v("td",[t._v("指命令执行期间产生的处理器指令数")])]),t._v(" "),v("tr",[v("td",[t._v("branches")]),t._v(" "),v("td",[t._v("指程序在执行期间遇到的分支指令数。")])]),t._v(" "),v("tr",[v("td",[t._v("branch‐misses")]),t._v(" "),v("td",[t._v("预测错误的分支指令数。")])]),t._v(" "),v("tr",[v("td",[t._v("XXX seconds time elapsed")]),t._v(" "),v("td",[t._v("系程序持续时间任务执行时间/任务持续时间大于1，那可以肯定是多核引起的")])])])]),t._v(" "),v("h4",{attrs:{id:"_3-perf-record"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-perf-record"}},[t._v("#")]),t._v(" (3)perf record")]),t._v(" "),v("p",[t._v("记录一段时间内系统/进程的性能时间")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("信息")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("-e")]),t._v(" "),v("td",[t._v("选择性能事件")])]),t._v(" "),v("tr",[v("td",[t._v("-p")]),t._v(" "),v("td",[t._v("待分析进程的id")])]),t._v(" "),v("tr",[v("td",[t._v("-t")]),t._v(" "),v("td",[t._v("待分析线程的id")])]),t._v(" "),v("tr",[v("td",[t._v("-a")]),t._v(" "),v("td",[t._v("分析整个系统的性能")])]),t._v(" "),v("tr",[v("td",[t._v("-C")]),t._v(" "),v("td",[t._v("只采集指定CPU数据")])]),t._v(" "),v("tr",[v("td",[t._v("-c")]),t._v(" "),v("td",[t._v("事件的采样周期")])]),t._v(" "),v("tr",[v("td",[t._v("-o")]),t._v(" "),v("td",[t._v("指定输出文件，默认为perf.data")])]),t._v(" "),v("tr",[v("td",[t._v("-A")]),t._v(" "),v("td",[t._v("以append的方式写输出文件")])]),t._v(" "),v("tr",[v("td",[t._v("-f")]),t._v(" "),v("td",[t._v("以OverWrite的方式写输出文件")])]),t._v(" "),v("tr",[v("td",[t._v("-g")]),t._v(" "),v("td",[t._v("记录函数间的调用关系")])])])]),t._v(" "),v("h4",{attrs:{id:"_4-perf-report"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-perf-report"}},[t._v("#")]),t._v(" (4)perf report")]),t._v(" "),v("p",[t._v("读取perf record生成的数据文件，并显示分析数据")])])}),[],!1,null,null,null);_.default=d.exports}}]);